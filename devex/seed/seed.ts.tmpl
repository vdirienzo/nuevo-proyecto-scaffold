/**
 * TypeScript Database Seeder
 * Author: {{AUTHOR}}
 * Project: {{PROJECT_NAME}}
 */

import { PrismaClient } from "@prisma/client";
import { userFactory } from "./factories/user.factory";
import userData from "./data/users.json";

const prisma = new PrismaClient();

async function main() {
  console.log("ðŸŒ± Starting database seed...");

  // Clear existing data
  console.log("ðŸ§¹ Clearing existing data...");
  await prisma.user.deleteMany();

  // Seed users from JSON file
  console.log("ðŸ‘¥ Seeding users from JSON...");
  for (const user of userData) {
    await prisma.user.create({
      data: user,
    });
  }
  console.log(`âœ… Created ${userData.length} users from JSON`);

  // Generate additional random users with Faker
  console.log("ðŸŽ² Generating random users...");
  const randomUsers = Array.from({ length: 10 }, () => userFactory());

  for (const user of randomUsers) {
    await prisma.user.create({
      data: user,
    });
  }
  console.log(`âœ… Created ${randomUsers.length} random users`);

  // Summary
  const totalUsers = await prisma.user.count();
  console.log("\nðŸ“Š Seed Summary:");
  console.log(`   Total Users: ${totalUsers}`);
  console.log("\nâœ¨ Seed completed successfully!");
}

main()
  .catch((e) => {
    console.error("âŒ Seed failed:", e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
