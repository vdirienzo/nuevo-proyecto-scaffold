# trivy-secret.yaml - Secret Detection Rules
# Author: {{AUTHOR}}

rules:
  - id: aws-access-key-id
    category: AWS
    title: AWS Access Key ID
    severity: CRITICAL
    regex: '(?i)AKIA[0-9A-Z]{16}'

  - id: aws-secret-access-key
    category: AWS
    title: AWS Secret Access Key
    severity: CRITICAL
    regex: '(?i)aws(.{0,20})?[''"][0-9a-zA-Z/+]{40}[''"]'

  - id: github-token
    category: GitHub
    title: GitHub Token
    severity: CRITICAL
    regex: 'gh[pousr]_[A-Za-z0-9_]{36,}'

  - id: jwt-token
    category: JWT
    title: JSON Web Token
    severity: HIGH
    regex: 'eyJ[A-Za-z0-9-_=]+\.eyJ[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*'

  - id: private-key
    category: AsymmetricPrivateKey
    title: Private Key
    severity: CRITICAL
    regex: '-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----'

allow-rules:
  - id: test-data
    description: Allow test/mock data
    path: '(test|spec|mock|fixture).*\.(ts|js|py)$'
