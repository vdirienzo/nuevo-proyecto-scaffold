# gitleaks.toml - Gitleaks Configuration
# Author: {{AUTHOR}}
# Project: {{PROJECT_NAME}}

title = "{{PROJECT_NAME}} Gitleaks Config"

[extend]
useDefault = true

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
tags = ["aws", "credentials"]
keywords = ["akia", "agpa", "aida", "aroa", "aipa", "anpa", "anva", "asia"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws_secret_access_key[\s]*[=:][\s]*['\"]?([A-Za-z0-9/+=]{40})['\"]?'''
tags = ["aws", "credentials"]
secretGroup = 1

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''ghp_[A-Za-z0-9_]{36,}'''
tags = ["github", "token"]

[[rules]]
id = "github-oauth"
description = "GitHub OAuth Access Token"
regex = '''gho_[A-Za-z0-9_]{36,}'''
tags = ["github", "oauth"]

[[rules]]
id = "jwt-token"
description = "JSON Web Token"
regex = '''eyJ[A-Za-z0-9-_]+\.eyJ[A-Za-z0-9-_]+\.[A-Za-z0-9-_.+/]*'''
tags = ["jwt", "token"]
entropy = 3.5

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH|PGP) PRIVATE KEY( BLOCK)?-----'''
tags = ["key", "private"]

[[rules]]
id = "slack-webhook"
description = "Slack Webhook URL"
regex = '''https://hooks\.slack\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[A-Za-z0-9]+'''
tags = ["slack", "webhook"]

[[rules]]
id = "stripe-api-key"
description = "Stripe API Key"
regex = '''(?i)(sk|rk)_(test|live)_[A-Za-z0-9]{24,}'''
tags = ["stripe", "api-key"]

[[rules]]
id = "supabase-key"
description = "Supabase Service Key"
regex = '''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.eyJpc3MiOiJzdXBhYmFzZS'''
tags = ["supabase", "api-key"]

[[rules]]
id = "database-url"
description = "Database Connection String"
regex = '''(?i)(postgres|mysql|mongodb|redis):\/\/[^\s'"]+'''
tags = ["database", "credentials"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?token)[\s]*[=:][\s]*['\"]?([A-Za-z0-9_\-]{20,})['\"]?'''
secretGroup = 2
entropy = 3.5
tags = ["api-key", "generic"]

[allowlist]
description = "Global Allowlist"
paths = [
  '''(^|/)\.git/''',
  '''node_modules/''',
  '''vendor/''',
  '''\.venv/''',
  '''dist/''',
  '''build/''',
  '''\.next/''',
  '''__pycache__/''',
]
regexes = [
  '''EXAMPLE_''',
  '''PLACEHOLDER_''',
  '''YOUR_.*_HERE''',
  '''<.*>''',
  '''xxx+''',
]
commits = []

[[rules.allowlist]]
id = "test-files"
paths = [
  '''test[s]?/''',
  '''spec/''',
  '''__tests__/''',
  '''\.test\.(ts|js|tsx|jsx)$''',
  '''\.spec\.(ts|js|tsx|jsx)$''',
  '''conftest\.py$''',
  '''test_.*\.py$''',
]

[rules.allowlist]
commits = []
paths = []
