/**
 * auth.resolver.ts - Authentication GraphQL Resolver
 *
 * Author: {{AUTHOR}}
 * Project: {{PROJECT_NAME}}
 */

import { Resolver, Mutation, Args } from '@nestjs/graphql';
import { UseGuards } from '@nestjs/common';
import { AuthPayload } from '../models/auth-payload.model';
import { CreateUserInput } from '../inputs/create-user.input';
import { LoginInput } from '../inputs/login.input';
import { GqlAuthGuard } from '../guards/gql-auth.guard';
import { CurrentUser } from '../decorators/current-user.decorator';
import { User } from '../models/user.model';

@Resolver()
export class AuthResolver {
  constructor(
    // Inject your AuthService here
    // private readonly authService: AuthService,
  ) {}

  @Mutation(() => AuthPayload, { description: 'Register new user' })
  async register(@Args('input') input: CreateUserInput): Promise<AuthPayload> {
    // const result = await this.authService.register(input);
    // return result;

    // Placeholder implementation
    return {
      accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...',
      refreshToken: 'refresh_token_here',
      user: {
        id: '1',
        email: input.email,
        name: input.name,
        createdAt: new Date(),
        updatedAt: new Date(),
      },
    };
  }

  @Mutation(() => AuthPayload, { description: 'Login user' })
  async login(@Args('input') input: LoginInput): Promise<AuthPayload> {
    // const result = await this.authService.login(input);
    // return result;

    // Placeholder implementation
    return {
      accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...',
      refreshToken: 'refresh_token_here',
      user: {
        id: '1',
        email: input.email,
        name: 'John Doe',
        createdAt: new Date(),
        updatedAt: new Date(),
      },
    };
  }

  @Mutation(() => Boolean, { description: 'Logout current user' })
  @UseGuards(GqlAuthGuard)
  async logout(@CurrentUser() user: User): Promise<boolean> {
    // await this.authService.logout(user.id);
    return true;
  }
}
