/**
 * Redis Configuration
 *
 * Author: {{AUTHOR}}
 * Project: {{PROJECT_NAME}}
 */

import { z } from 'zod';

const redisConfigSchema = z.object({
  host: z.string().default('localhost'),
  port: z.number().int().positive().default(6379),
  password: z.string().optional(),
  db: z.number().int().min(0).default(0),
  keyPrefix: z.string().default('{{PROJECT_NAME}}:'),
  ttl: z.number().int().positive().default(3600), // 1 hour default
  maxRetriesPerRequest: z.number().int().positive().default(3),
});

export type RedisConfig = z.infer<typeof redisConfigSchema>;

export const redisConfig: RedisConfig = redisConfigSchema.parse({
  host: process.env.REDIS_HOST || 'localhost',
  port: parseInt(process.env.REDIS_PORT || '6379', 10),
  password: process.env.REDIS_PASSWORD,
  db: parseInt(process.env.REDIS_DB || '0', 10),
  keyPrefix: process.env.REDIS_KEY_PREFIX || '{{PROJECT_NAME}}:',
  ttl: parseInt(process.env.REDIS_TTL || '3600', 10),
  maxRetriesPerRequest: parseInt(process.env.REDIS_MAX_RETRIES || '3', 10),
});

// Key namespaces
export const REDIS_KEYS = {
  CACHE: 'cache:',
  SESSION: 'session:',
  RATE_LIMIT: 'rate-limit:',
  QUEUE: 'queue:',
  LOCK: 'lock:',
  PUBSUB: 'pubsub:',
} as const;

// TTL presets (in seconds)
export const REDIS_TTL = {
  VERY_SHORT: 60, // 1 minute
  SHORT: 300, // 5 minutes
  MEDIUM: 1800, // 30 minutes
  LONG: 3600, // 1 hour
  VERY_LONG: 86400, // 24 hours
  WEEK: 604800, // 7 days
} as const;
